<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Introduction to Stata (SOC 510)</title>
  <meta name="description" content="Introduction to Stata (SOC 510)">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Introduction to Stata (SOC 510)" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Introduction to Stata (SOC 510)" />
  
  
  

<meta name="author" content="Josh Errickson">


<meta name="date" content="2017-09-12">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="basics.html">
<link rel="next" href="data-management.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />










<link rel="stylesheet" href="css/standard_html.css" type="text/css" />
<link rel="stylesheet" href="css/book.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">Introduction to Stata</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#how-to-use-this-document"><i class="fa fa-check"></i><b>1.1</b> How to use this document</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#stata-14-vs-stata-15"><i class="fa fa-check"></i><b>1.1.1</b> Stata 14 vs Stata 15</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#contact-information"><i class="fa fa-check"></i><b>1.2</b> Contact information</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#cscar"><i class="fa fa-check"></i><b>1.2.1</b> CSCAR</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#author"><i class="fa fa-check"></i><b>1.2.2</b> Author</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i><b>1.3</b> Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>2</b> Basics</a><ul>
<li class="chapter" data-level="2.1" data-path="basics.html"><a href="basics.html#the-stata-environment"><i class="fa fa-check"></i><b>2.1</b> The Stata Environment</a></li>
<li class="chapter" data-level="2.2" data-path="basics.html"><a href="basics.html#one-data"><i class="fa fa-check"></i><b>2.2</b> One Data</a></li>
<li class="chapter" data-level="2.3" data-path="basics.html"><a href="basics.html#give-stata-a-command"><i class="fa fa-check"></i><b>2.3</b> Give Stata a command</a><ul>
<li class="chapter" data-level="2.3.1" data-path="basics.html"><a href="basics.html#saving-results"><i class="fa fa-check"></i><b>2.3.1</b> Saving Results</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="basics.html"><a href="basics.html#do-files"><i class="fa fa-check"></i><b>2.4</b> Do-files</a><ul>
<li class="chapter" data-level="2.4.1" data-path="basics.html"><a href="basics.html#comments"><i class="fa fa-check"></i><b>2.4.1</b> Comments</a></li>
<li class="chapter" data-level="2.4.2" data-path="basics.html"><a href="basics.html#version-control"><i class="fa fa-check"></i><b>2.4.2</b> Version control</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="basics.html"><a href="basics.html#basic-command-syntax"><i class="fa fa-check"></i><b>2.5</b> Basic command syntax</a><ul>
<li class="chapter" data-level="2.5.1" data-path="basics.html"><a href="basics.html#referring-to-variables"><i class="fa fa-check"></i><b>2.5.1</b> Referring to variables</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="basics.html"><a href="basics.html#stata-help"><i class="fa fa-check"></i><b>2.6</b> Stata Help</a><ul>
<li class="chapter" data-level="2.6.1" data-path="basics.html"><a href="basics.html#short-commands"><i class="fa fa-check"></i><b>2.6.1</b> Short commands</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="basics.html"><a href="basics.html#set-more-off"><i class="fa fa-check"></i><b>2.7</b> <code>set more off</code></a></li>
<li class="chapter" data-level="2.8" data-path="basics.html"><a href="basics.html#working-directory"><i class="fa fa-check"></i><b>2.8</b> Working directory</a><ul>
<li class="chapter" data-level="2.8.1" data-path="basics.html"><a href="basics.html#file-paths"><i class="fa fa-check"></i><b>2.8.1</b> File paths</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="working-with-data-sets.html"><a href="working-with-data-sets.html"><i class="fa fa-check"></i><b>3</b> Working with Data Sets</a><ul>
<li class="chapter" data-level="3.1" data-path="working-with-data-sets.html"><a href="working-with-data-sets.html#built-in-data"><i class="fa fa-check"></i><b>3.1</b> Built-in data</a></li>
<li class="chapter" data-level="3.2" data-path="working-with-data-sets.html"><a href="working-with-data-sets.html#opening-data"><i class="fa fa-check"></i><b>3.2</b> Opening data</a></li>
<li class="chapter" data-level="3.3" data-path="working-with-data-sets.html"><a href="working-with-data-sets.html#saving-data"><i class="fa fa-check"></i><b>3.3</b> Saving data</a></li>
<li class="chapter" data-level="3.4" data-path="working-with-data-sets.html"><a href="working-with-data-sets.html#preserverestore"><i class="fa fa-check"></i><b>3.4</b> <code>preserve</code>/<code>restore</code></a></li>
<li class="chapter" data-level="3.5" data-path="working-with-data-sets.html"><a href="working-with-data-sets.html#exercise-1"><i class="fa fa-check"></i><b>3.5</b> Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-management.html"><a href="data-management.html"><i class="fa fa-check"></i><b>4</b> Data Management</a><ul>
<li class="chapter" data-level="4.1" data-path="data-management.html"><a href="data-management.html#describe"><i class="fa fa-check"></i><b>4.1</b> <code>describe</code></a></li>
<li class="chapter" data-level="4.2" data-path="data-management.html"><a href="data-management.html#labels"><i class="fa fa-check"></i><b>4.2</b> Labels</a><ul>
<li class="chapter" data-level="4.2.1" data-path="data-management.html"><a href="data-management.html#label-variable"><i class="fa fa-check"></i><b>4.2.1</b> <code>label variable</code></a></li>
<li class="chapter" data-level="4.2.2" data-path="data-management.html"><a href="data-management.html#label-values"><i class="fa fa-check"></i><b>4.2.2</b> <code>label values</code></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-management.html"><a href="data-management.html#managing-variables"><i class="fa fa-check"></i><b>4.3</b> Managing variables</a></li>
<li class="chapter" data-level="4.4" data-path="data-management.html"><a href="data-management.html#summarizing-the-data"><i class="fa fa-check"></i><b>4.4</b> Summarizing the data</a></li>
<li class="chapter" data-level="4.5" data-path="data-management.html"><a href="data-management.html#exercise-2"><i class="fa fa-check"></i><b>4.5</b> Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-manipulation.html"><a href="data-manipulation.html"><i class="fa fa-check"></i><b>5</b> Data Manipulation</a><ul>
<li class="chapter" data-level="5.1" data-path="data-manipulation.html"><a href="data-manipulation.html#generate"><i class="fa fa-check"></i><b>5.1</b> <code>generate</code></a><ul>
<li class="chapter" data-level="5.1.1" data-path="data-manipulation.html"><a href="data-manipulation.html#extension-to-generate"><i class="fa fa-check"></i><b>5.1.1</b> Extension to <code>generate</code></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-manipulation.html"><a href="data-manipulation.html#replace"><i class="fa fa-check"></i><b>5.2</b> <code>replace</code></a><ul>
<li class="chapter" data-level="5.2.1" data-path="data-manipulation.html"><a href="data-manipulation.html#conditional-variable-generation"><i class="fa fa-check"></i><b>5.2.1</b> Conditional variable generation</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="data-manipulation.html"><a href="data-manipulation.html#missing-values"><i class="fa fa-check"></i><b>5.3</b> Missing values</a></li>
<li class="chapter" data-level="5.4" data-path="data-manipulation.html"><a href="data-manipulation.html#subsetting"><i class="fa fa-check"></i><b>5.4</b> Subsetting</a><ul>
<li class="chapter" data-level="5.4.1" data-path="data-manipulation.html"><a href="data-manipulation.html#by-and-bysort"><i class="fa fa-check"></i><b>5.4.1</b> <code>by</code> and <code>bysort</code></a></li>
<li class="chapter" data-level="5.4.2" data-path="data-manipulation.html"><a href="data-manipulation.html#keep-drop"><i class="fa fa-check"></i><b>5.4.2</b> <code>keep</code>, <code>drop</code></a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-manipulation.html"><a href="data-manipulation.html#sorting"><i class="fa fa-check"></i><b>5.5</b> Sorting</a></li>
<li class="chapter" data-level="5.6" data-path="data-manipulation.html"><a href="data-manipulation.html#exercise-3"><i class="fa fa-check"></i><b>5.6</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="programming.html"><a href="programming.html"><i class="fa fa-check"></i><b>6</b> Programming</a><ul>
<li class="chapter" data-level="6.1" data-path="programming.html"><a href="programming.html#macros"><i class="fa fa-check"></i><b>6.1</b> Macros</a><ul>
<li class="chapter" data-level="6.1.1" data-path="programming.html"><a href="programming.html#class-and-return"><i class="fa fa-check"></i><b>6.1.1</b> Class and Return</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="programming.html"><a href="programming.html#loops"><i class="fa fa-check"></i><b>6.2</b> loops</a></li>
<li class="chapter" data-level="6.3" data-path="programming.html"><a href="programming.html#suppressing-output-and-errors"><i class="fa fa-check"></i><b>6.3</b> Suppressing output and errors</a><ul>
<li class="chapter" data-level="6.3.1" data-path="programming.html"><a href="programming.html#capture"><i class="fa fa-check"></i><b>6.3.1</b> <code>capture</code></a></li>
<li class="chapter" data-level="6.3.2" data-path="programming.html"><a href="programming.html#quietly"><i class="fa fa-check"></i><b>6.3.2</b> <code>quietly</code></a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Stata (SOC 510)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="working-with-data-sets" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Working with Data Sets</h1>
<div id="built-in-data" class="section level2">
<h2><span class="header-section-number">3.1</span> Built-in data</h2>
<p>
Before we turn to using your own data, it is useful to know that Stata comes with a collection of sample data sets which you can use to try the Stata commands. Additionally, most (if not all) of the examples in <a href="basics.html#stata-help">Stata help</a> will use these data sets.
</p>
<p>
To see a list of the built-in data sets, use
</p>
<pre><code>. sysuse dir
  RDSL.subset.dta  census.dta       network1a.dta    tsline1.dta
  auto.dta         citytemp.dta     nlsw88.dta       tsline2.dta
  auto2.dta        citytemp4.dta    nlswide1.dta     uslifeexp.dta
  autornd.dta      educ99gdp.dta    pop2000.dta      uslifeexp2.dta
  bplong.dta       gnp96.dta        sandstone.dta    voter.dta
  bpwide.dta       lifeexp.dta      sp500.dta        xtline1.dta
  cancer.dta       network1.dta     surface.dta

</code></pre>
<p>
and use <code>sysuse</code> again to load data, for example the <code>auto</code> data which contains characteristics of various cars from a 1978 Consumer’s Report magazine.
</p>
<pre><code>. sysuse auto
(1978 Automobile Data)

</code></pre>
<p>
If you make any modifications to your data, Stata will try and protect you by refusing to load a new data set which would dispose of your changes. If you are willing to dispose of your changes, you can either manually do it by calling
</p>
<pre><code>clear
</code></pre>
<p>
or passing it as an option to <code>sysuse</code>,
</p>
<pre><code>. sysuse auto, clear
(1978 Automobile Data)

</code></pre>
</div>
<div id="opening-data" class="section level2">
<h2><span class="header-section-number">3.2</span> Opening data</h2>
<p>
As you may have guessed from the <code>sysuse</code> command above, the command to load local data is <code>use</code>:
</p>
<pre><code>use &lt;filename&gt;
</code></pre>
<p>
As discussed in the <a href="basics.html#working-directory">working directory</a> section, Stata can see only files in its working directory, so only the name of the file needs to be passed. If the file exists in a different directory, you will need to give the full (or relative path). For example, if your working directory is “C:” and the file you are looking for, “mydata.dta”, is in the “Project” subfolder, you could open it with any of the following:
</p>
<pre><code>use C:\Documents\Stata\Project\mydata.dta
use Project\mydata.dta
cd Documents\Stata\Project
use mydata.dta
</code></pre>
<p>
Note that if the path (or file name) contains any spaces, you need to wrap the entire thing in quotes:
</p>
<pre><code>use &quot;C:\Documents\Stata\My Project\My Data&quot;
</code></pre>
<p>
It is never wrong to use quotes (just not always required), so perhaps that’s a safer option.
</p>
<p>
If the location of your file is much different than your working directory, it can be quicker just to use the menu “File -&gt; Open” and use the file open dialog box instead. As with all commands, the <code>use</code> command will be echoed in the Results after using the dialog box, allowing you to add it to a Do-file.
</p>
<p>
As with <code>sysuse</code>, the <code>clear</code> option discards the existing data regardless of unsaved changes.
</p>
</div>
<div id="saving-data" class="section level2">
<h2><span class="header-section-number">3.3</span> Saving data</h2>
<p>
The <code>save</code> command can be used to save a data set. Without any further arguments, it saves the existing file with the same name.
</p>
<pre><code>save
</code></pre>
<p>
However, Stata again tries to save you from yourself and does not allow you to overwrite an existing file, so you’ll basically never run <code>save</code> by itself. Instead, passing the <code>replace</code> option allows you to overwrite existing files:
</p>
<pre><code>save, replace
</code></pre>
<p>
Finally, we can pass a name to the command to save a file with a different name:
</p>
<pre><code>save mynewdata.dta
</code></pre>
<p>
This can also take a <code>replace</code> option.
</p>
<p>
<code>save</code> follows the same logic as <code>use</code> with regards to the working directory; it saves in the working directory unless you pass a path. Additionally, a file name with spaces needs to be wrapped in quotes.
</p>
<p>
The File -&gt; Save (and Save As) menu options can be used instead.
</p>
<p>
System data (loaded with <a href="working-with-data-sets.html#built-in-data"><code>sysuse</code></a>) can only be saved as a new file; you cannot (easily) modify the built-in data.q
</p>
</div>
<div id="preserverestore" class="section level2">
<h2><span class="header-section-number">3.4</span> <code>preserve</code>/<code>restore</code></h2>
<p>
Along with the <a href="basics.html#one-data">One Data</a> principal, if you wished to modify a data set temporarily, say to remove some subset of your observations, it must be done destructively. One workflow to use would be:
</p>
<pre><code>sysuse auto
&lt;modify data set as desired&gt;
save tmp
&lt;subset data&gt;
&lt;obtain results&gt;
use tmp, clear
&lt;delete the tmp file manually&gt;
</code></pre>
<p>
Alternatively, the <code>preserve</code> and <code>restore</code> commands perform the same set of operations in a more automated fashion:
</p>
<pre><code>sysuse auto
&lt;modify data set as desired&gt;
preserve
&lt;subset data&gt;
&lt;obtain results&gt;
restore
</code></pre>
<p>
The <code>preserve</code> command saves an image of the data as they are now, and the <code>restore</code> command reloads the image of the data, discarding any interim changes. There can only be a single image of the data preserved at a time, so if you <code>preserve</code>, then make a change and want to <code>preserve</code> again (without an intervening <code>restore</code>), you’ll need to desroy the existing preserved state by passing the option <code>not</code> to <code>restore</code>.
</p>
<pre><code>restore, not
</code></pre>
</div>
<div id="exercise-1" class="section level2">
<h2><span class="header-section-number">3.5</span> Exercise 1</h2>
<p>
You can access the file you’ll be working with in this class here: <a href="RDSL.subset.dta">RDSL.subset.dta</a>.
</p>
<ol>
<li>
Download the data and move it into your M drive.
</li>
<li>
Open the data with Stata (either double click on the file, or use File -&gt; Open, or use <code>use</code>).
</li>
<li>
Use <code>pwd</code> to ensure that directory containing the data file is the working directory. If not, use File -&gt; Change Working Directory or <code>cd</code> to fix it.
</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="basics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-management.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
