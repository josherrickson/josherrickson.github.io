<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Variable Lists | Stata 16 - New Features</title>
  <meta name="description" content="Chapter 3 Variable Lists | Stata 16 - New Features" />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Variable Lists | Stata 16 - New Features" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Variable Lists | Stata 16 - New Features" />
  
  
  

<meta name="author" content="Josh Errickson" />


<meta name="date" content="2019-09-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="frames.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />










<link rel="stylesheet" href="css/standard_html.css" type="text/css" />
<link rel="stylesheet" href="css/book.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">Stata 16 - New Features</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#how-to-use-this-document"><i class="fa fa-check"></i><b>1.1</b> How to use this document</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#contact-information"><i class="fa fa-check"></i><b>1.2</b> Contact information</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#cscar"><i class="fa fa-check"></i><b>1.2.1</b> CSCAR</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#author"><i class="fa fa-check"></i><b>1.2.2</b> Author</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#usage"><i class="fa fa-check"></i><b>1.3</b> Usage</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="frames.html"><a href="frames.html"><i class="fa fa-check"></i><b>2</b> Frames</a><ul>
<li class="chapter" data-level="2.1" data-path="frames.html"><a href="frames.html#when-might-you-use-frames"><i class="fa fa-check"></i><b>2.1</b> When might you use frames?</a></li>
<li class="chapter" data-level="2.2" data-path="frames.html"><a href="frames.html#the-basics"><i class="fa fa-check"></i><b>2.2</b> The basics</a></li>
<li class="chapter" data-level="2.3" data-path="frames.html"><a href="frames.html#aliases"><i class="fa fa-check"></i><b>2.3</b> Aliases</a></li>
<li class="chapter" data-level="2.4" data-path="frames.html"><a href="frames.html#remember-to-drop-frames"><i class="fa fa-check"></i><b>2.4</b> Remember to drop frames!</a></li>
<li class="chapter" data-level="2.5" data-path="frames.html"><a href="frames.html#copying-into-frames"><i class="fa fa-check"></i><b>2.5</b> Copying into frames</a></li>
<li class="chapter" data-level="2.6" data-path="frames.html"><a href="frames.html#executing-commands-in-a-different-frame"><i class="fa fa-check"></i><b>2.6</b> Executing commands in a different frame</a></li>
<li class="chapter" data-level="2.7" data-path="frames.html"><a href="frames.html#linking-data-sets"><i class="fa fa-check"></i><b>2.7</b> Linking data sets</a><ul>
<li class="chapter" data-level="2.7.1" data-path="frames.html"><a href="frames.html#working-with-linked-frames"><i class="fa fa-check"></i><b>2.7.1</b> Working with linked frames</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="variable-lists.html"><a href="variable-lists.html"><i class="fa fa-check"></i><b>3</b> Variable Lists</a><ul>
<li class="chapter" data-level="3.1" data-path="variable-lists.html"><a href="variable-lists.html#initialization-of-variable-lists"><i class="fa fa-check"></i><b>3.1</b> Initialization of Variable Lists</a></li>
<li class="chapter" data-level="3.2" data-path="variable-lists.html"><a href="variable-lists.html#viewing-lists"><i class="fa fa-check"></i><b>3.2</b> Viewing lists</a><ul>
<li class="chapter" data-level="3.2.1" data-path="variable-lists.html"><a href="variable-lists.html#moving-variables-in-system-lists"><i class="fa fa-check"></i><b>3.2.1</b> Moving variables in system lists</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="variable-lists.html"><a href="variable-lists.html#user-variable-lists"><i class="fa fa-check"></i><b>3.3</b> User Variable Lists</a><ul>
<li class="chapter" data-level="3.3.1" data-path="variable-lists.html"><a href="variable-lists.html#modifying-user-variable-lists"><i class="fa fa-check"></i><b>3.3.1</b> Modifying User Variable Lists</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="variable-lists.html"><a href="variable-lists.html#dropping-variable-list"><i class="fa fa-check"></i><b>3.4</b> Dropping variable list</a></li>
<li class="chapter" data-level="3.5" data-path="variable-lists.html"><a href="variable-lists.html#using-variable-lists"><i class="fa fa-check"></i><b>3.5</b> Using Variable Lists</a><ul>
<li class="chapter" data-level="3.5.1" data-path="variable-lists.html"><a href="variable-lists.html#updating-factor-variable-lists"><i class="fa fa-check"></i><b>3.5.1</b> Updating factor-variable Lists</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="variable-lists.html"><a href="variable-lists.html#stored-statistics"><i class="fa fa-check"></i><b>3.6</b> Stored Statistics</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Stata 16 - New Features</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="variable-lists" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Variable Lists</h1>
<p>
A common technique in previous versions of Stata was to define a global containing a list of variables to be used later in the document. For example, you might see something like this at the top of a Do file:
</p>
<pre><code>global predictors x1 x2 x3 x4
</code></pre>
<p>
then further down the document something like
</p>
<pre><code>regress y $predictors
logit z $predictors
</code></pre>
<p>
In Stata 16, Stata has formalized this concept with the addition of the <code>vl</code> command (<strong>v</strong>ariable <strong>l</strong>ist). It works similarly to the use of globals: lists of variables are defined, then later reference via the <code>$name</code> syntax. However, using <code>vl</code> has the benefits of improved organization, customizations unique to variable lists, error checking, and overall convenience.
</p>
<div id="initialization-of-variable-lists" class="section level2">
<h2><span class="header-section-number">3.1</span> Initialization of Variable Lists</h2>
<p>
To begin using variable lists, <code>vl set</code> must be run.
</p>
<pre><code>. sysuse auto
(1978 Automobile Data)

. vl set

-------------------------------------------------------------------------------
                  |                      Macro's contents
                  |------------------------------------------------------------
Macro             |  # Vars   Description
------------------+------------------------------------------------------------
System            |
  $vlcategorical  |       2   categorical variables
  $vlcontinuous   |       2   continuous variables
  $vluncertain    |       7   perhaps continuous, perhaps categorical variables
  $vlother        |       0   all missing or constant variables
-------------------------------------------------------------------------------
Notes

      1. Review contents of vlcategorical and vlcontinuous to ensure they are
         correct.  Type vl list vlcategorical and type vl list vlcontinuous.

      2. If there are any variables in vluncertain, you can reallocate them
         to vlcategorical, vlcontinuous, or vlother.  Type
         vl list vluncertain.

      3. Use vl move to move variables among classifications.  For example,
         type vl move (x50 x80) vlcontinuous to move variables x50 and x80 to
         the continuous classification.

      4. vlnames are global macros.  Type the vlname without the leading
         dollar sign ($) when using vl commands.  Example: vlcategorical not
         $vlcategorical.  Type the dollar sign with other Stata commands to
         get a varlist.

</code></pre>
<p>
This produces a surprisingly large amount of output. When you initialize the use of variable lists, Stata will automatically create four variable lists, called the “System variable lists”. Every <em>numeric</em> variable in the current data set is automatically placed into one of these four lists:
</p>
<ul>
<li>
<code>vlcategorical</code>: Variables which Stata thinks are categorical. These generally have to be non-negative, integer valued variables with less than 10 unique values.
</li>
<li>
<code>vlcontinuous</code>: Variables which Stata thinks are continuous. These generally are variables which have negative values, have non-integer values, or are non-negative integers with more than 100 unique values.
</li>
<li>
<code>vluncertain</code>: Variables which Stata is unsure whether they are continuous or categorical. These generally are non-negative integer valued variables with between 10 and 100 unique values.
</li>
<li>
<code>vlother</code>: Any numeric variables that aren’t really useful - either all missing or constant variables.
</li>
</ul>
<p>
There is a potential fifth system variable list, <code>vldummy</code>, which is created when option <code>dummy</code> is passed. Unsurprisingly, this will take variables containing only values 0 and 1 out of <code>vlcategorical</code> and into this list.
</p>
<p>
The “Notes” given below the output are generic; they appear regardless of how well Stata was able to categorize the variables. They can be suppressed with the <code>nonotes</code> option to <code>vl set</code><a href="variable-lists.html#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.
</p>
<p>
The two thresholds given above, 10 and 100, can be adjusted by the <code>categorical</code> and <code>uncertain</code> options. For example,
</p>
<pre><code>vl set, categorical(20) uncertain(50)
</code></pre>
<p>
Running <code>vl set</code> on an already <code>vl</code>-set data set will result in an error, unless the <code>clear</code> option is given, which will re-generate the lists.
</p>
<pre><code>. vl set, dummy nonotes
one or more already classified variables specified
    You requested that variables be added to vl's system classifications, but
    you specified 11 variables that were already classified.
r(110);

. vl set, dummy nonotes clear

-------------------------------------------------------------------------------
                  |                      Macro's contents
                  |------------------------------------------------------------
Macro             |  # Vars   Description
------------------+------------------------------------------------------------
System            |
  $vldummy        |       1   0/1 variable
  $vlcategorical  |       1   categorical variable
  $vlcontinuous   |       2   continuous variables
  $vluncertain    |       7   perhaps continuous, perhaps categorical variables
  $vlother        |       0   all missing or constant variables
-------------------------------------------------------------------------------

</code></pre>
<p>
In the above, we changed our minds and wanted to include the <code>vldummy</code> list, but since we’d already <code>vl</code>-set, we had the <code>clear</code> the existing set.
</p>
</div>
<div id="viewing-lists" class="section level2">
<h2><span class="header-section-number">3.2</span> Viewing lists</h2>
<p>
When initializing the variable lists, we’re treated to a nice table of all defined lists. We can replay it via
</p>
<pre><code>. vl dir

-------------------------------------------------------------------------------
                  |                      Macro's contents
                  |------------------------------------------------------------
Macro             |  # Vars   Description
------------------+------------------------------------------------------------
System            |
  $vldummy        |       1   0/1 variable
  $vlcategorical  |       1   categorical variable
  $vlcontinuous   |       2   continuous variables
  $vluncertain    |       7   perhaps continuous, perhaps categorical variables
  $vlother        |       0   all missing or constant variables
-------------------------------------------------------------------------------

</code></pre>
<p>
To see the actual contents of the variable lists, we’ll need to sue <code>vl list</code>.
</p>
<pre><code>. vl list

----------------------------------------------------
    Variable | Macro           Values         Levels
-------------+--------------------------------------
     foreign | $vldummy        0 and 1             2
       rep78 | $vlcategorical  integers &gt;=0        5
    headroom | $vlcontinuous   noninteger           
  gear_ratio | $vlcontinuous   noninteger           
       price | $vluncertain    integers &gt;=0       74
         mpg | $vluncertain    integers &gt;=0       21
       trunk | $vluncertain    integers &gt;=0       18
      weight | $vluncertain    integers &gt;=0       64
      length | $vluncertain    integers &gt;=0       47
        turn | $vluncertain    integers &gt;=0       18
displacement | $vluncertain    integers &gt;=0       31
----------------------------------------------------

</code></pre>
<p>
This output produces one row for each variable <em>in each variable list it is in</em>. We haven’t used this yet, but variables can be in multiple lists.
</p>
<p>
We can list only specific lists:
</p>
<pre><code>. vl list vlcategorical

------------------------------------------------
Variable | Macro           Values         Levels
---------+--------------------------------------
   rep78 | $vlcategorical  integers &gt;=0        5
------------------------------------------------

</code></pre>
<p>
or specific variables
</p>
<pre><code>. vl list (turn weight)

------------------------------------------------
Variable | Macro           Values         Levels
---------+--------------------------------------
    turn | $vluncertain    integers &gt;=0       18
  weight | $vluncertain    integers &gt;=0       64
------------------------------------------------

</code></pre>
<p>
If “turn” was in multiple variable lists, each would appear as a row in this output.
</p>
<p>
There’s a bit of odd notation which can be used to sort the output by variable name, which makes it easier to identify variables which appear in multiple lists.
</p>
<pre><code>. vl list (_all), sort

----------------------------------------------------
    Variable | Macro           Values         Levels
-------------+--------------------------------------
displacement | $vluncertain    integers &gt;=0       31
     foreign | $vldummy        0 and 1             2
  gear_ratio | $vlcontinuous   noninteger           
    headroom | $vlcontinuous   noninteger           
      length | $vluncertain    integers &gt;=0       47
         mpg | $vluncertain    integers &gt;=0       21
       price | $vluncertain    integers &gt;=0       74
       rep78 | $vlcategorical  integers &gt;=0        5
       trunk | $vluncertain    integers &gt;=0       18
        turn | $vluncertain    integers &gt;=0       18
      weight | $vluncertain    integers &gt;=0       64
----------------------------------------------------

</code></pre>
<p>
The <code>(_all)</code> tells Stata to report on all variables, and sorting (when you specify at least one variable) orders by variable name rather than variable list name.
</p>
<p>
This will also list any numeric variables which are not found in <strong>any</strong> list.
</p>
<div id="moving-variables-in-system-lists" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Moving variables in system lists</h3>
<p>
After initializing the variable lists, if you plan on using the system lists, you may need to move variables around (e.g. classifying the <code>vluncertain</code> variables into their proper lists). This can be done via <code>vl move</code> which has the syntax
</p>
<pre><code>vl move (&lt;variables to move&gt;) &lt;destination list&gt;
</code></pre>
<p>
For example, all the variables in <code>vluncertain</code> are actually continuous:
</p>
<pre><code>. vl list vluncertain

----------------------------------------------------
    Variable | Macro           Values         Levels
-------------+--------------------------------------
       price | $vluncertain    integers &gt;=0       74
         mpg | $vluncertain    integers &gt;=0       21
       trunk | $vluncertain    integers &gt;=0       18
      weight | $vluncertain    integers &gt;=0       64
      length | $vluncertain    integers &gt;=0       47
        turn | $vluncertain    integers &gt;=0       18
displacement | $vluncertain    integers &gt;=0       31
----------------------------------------------------

. vl move (price mpg trunk weight length turn displacement) vlcontinuous
note: 7 variables specified and 7 variables moved

------------------------------
Macro          # Added/Removed
------------------------------
$vldummy                     0
$vlcategorical               0
$vlcontinuous                7
$vluncertain                -7
$vlother                     0
------------------------------

. vl dir

-------------------------------------------------------------------------------
                  |                      Macro's contents
                  |------------------------------------------------------------
Macro             |  # Vars   Description
------------------+------------------------------------------------------------
System            |
  $vldummy        |       1   0/1 variable
  $vlcategorical  |       1   categorical variable
  $vlcontinuous   |       9   continuous variables
  $vluncertain    |       0   perhaps continuous, perhaps categorical variables
  $vlother        |       0   all missing or constant variables
-------------------------------------------------------------------------------

</code></pre>
<p>
Alternatively, since we’re moving all variables in <code>vluncertain</code>, we can see our first use of the variable list!
</p>
<pre><code>. vl set, dummy nonotes clear

-------------------------------------------------------------------------------
                  |                      Macro's contents
                  |------------------------------------------------------------
Macro             |  # Vars   Description
------------------+------------------------------------------------------------
System            |
  $vldummy        |       1   0/1 variable
  $vlcategorical  |       1   categorical variable
  $vlcontinuous   |       2   continuous variables
  $vluncertain    |       7   perhaps continuous, perhaps categorical variables
  $vlother        |       0   all missing or constant variables
-------------------------------------------------------------------------------

. vl move ($vluncertain) vlcontinuous
note: 7 variables specified and 7 variables moved

------------------------------
Macro          # Added/Removed
------------------------------
$vldummy                     0
$vlcategorical               0
$vlcontinuous                7
$vluncertain                -7
$vlother                     0
------------------------------

</code></pre>
<p>
Note that variable lists are essentially just global macros so can be referred to via <code>$name</code>. Note, however, that the <code>$</code> is only used when we want to actually use the variable list as a macro - in this case, we wanted to expand <code>vluncertain</code> into it’s list of variables. When we’re referring to a variable list in the <code>vl</code> commands, we <em>do not</em> use the <code>$</code>.
</p>
</div>
</div>
<div id="user-variable-lists" class="section level2">
<h2><span class="header-section-number">3.3</span> User Variable Lists</h2>
<p>
In addition to the System variable lists, you can define your own User variables lists, which I imagine will be used far more often. These are easy to create with <code>vl create</code>:
</p>
<pre><code>. vl create mylist1 = (weight mpg)
note: $mylist1 initialized with 2 variables

. vl create mylist2 = (weight length trunk)
note: $mylist2 initialized with 3 variables

. vl dir, user

-------------------------------------------------------------------------------
                  |                      Macro's contents
                  |------------------------------------------------------------
Macro             |  # Vars   Description
------------------+------------------------------------------------------------
User              |
  $mylist1        |       2   variables
  $mylist2        |       3   variables
-------------------------------------------------------------------------------

. vl list, user

------------------------------------------------
Variable | Macro           Values         Levels
---------+--------------------------------------
  weight | $mylist1        integers &gt;=0       64
     mpg | $mylist1        integers &gt;=0       21
  weight | $mylist2        integers &gt;=0       64
  length | $mylist2        integers &gt;=0       47
   trunk | $mylist2        integers &gt;=0       18
------------------------------------------------

</code></pre>
<p>
Note the addition of the <code>user</code> option to <code>vl list</code> and <code>vl dir</code> to show only User variable lists and suppress the System variable lists. We can also demonstrate the odd sorting syntax here:
</p>
<pre><code>. vl list (_all), sort user

----------------------------------------------------
    Variable | Macro           Values         Levels
-------------+--------------------------------------
displacement | not in vluser                      31
     foreign | not in vluser                       2
  gear_ratio | not in vluser                        
    headroom | not in vluser                        
      length | $mylist2        integers &gt;=0       47
         mpg | $mylist1        integers &gt;=0       21
       price | not in vluser                      74
       rep78 | not in vluser                       5
       trunk | $mylist2        integers &gt;=0       18
        turn | not in vluser                      18
      weight | $mylist1        integers &gt;=0       64
      weight | $mylist2        integers &gt;=0       64
----------------------------------------------------

</code></pre>
<p>
You can refer to variable lists in all the usual shortcut ways:
</p>
<pre><code>vl create mylist = (x1-x100 z*)
</code></pre>
<p>
We can add labels to variable lists:
</p>
<pre><code>. vl label mylist1 &quot;Related to gas consumption&quot;

. vl label mylist2 &quot;Related to size&quot;

. vl dir, user

-------------------------------------------------------------------------------
                  |                      Macro's contents
                  |------------------------------------------------------------
Macro             |  # Vars   Description
------------------+------------------------------------------------------------
User              |
  $mylist1        |       2   Related to gas consumption
  $mylist2        |       3   Related to size
-------------------------------------------------------------------------------

</code></pre>
<div id="modifying-user-variable-lists" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Modifying User Variable Lists</h3>
<p>
First, note that with User Variable Lists, the <code>vl move</code> command <strong>does not work</strong>. It only works with system variable lists.
</p>
<p>
We can create new user variable lists which build off old lists with <code>vl create</code>. To add a new variable:
</p>
<pre><code>. vl create mylist3 = mylist2 + (gear_ratio)
note: $mylist3 initialized with 4 variables

. vl list, user

--------------------------------------------------
  Variable | Macro           Values         Levels
-----------+--------------------------------------
    weight | $mylist1        integers &gt;=0       64
       mpg | $mylist1        integers &gt;=0       21
    weight | $mylist2        integers &gt;=0       64
    length | $mylist2        integers &gt;=0       47
     trunk | $mylist2        integers &gt;=0       18
    weight | $mylist3        integers &gt;=0       64
    length | $mylist3        integers &gt;=0       47
     trunk | $mylist3        integers &gt;=0       18
gear_ratio | $mylist3        noninteger           
--------------------------------------------------

. vl create mylist4 = mylist2 - (turn)
note: $mylist4 initialized with 3 variables

. vl list, user

--------------------------------------------------
  Variable | Macro           Values         Levels
-----------+--------------------------------------
    weight | $mylist1        integers &gt;=0       64
       mpg | $mylist1        integers &gt;=0       21
    weight | $mylist2        integers &gt;=0       64
    length | $mylist2        integers &gt;=0       47
     trunk | $mylist2        integers &gt;=0       18
    weight | $mylist3        integers &gt;=0       64
    length | $mylist3        integers &gt;=0       47
     trunk | $mylist3        integers &gt;=0       18
gear_ratio | $mylist3        noninteger           
    weight | $mylist4        integers &gt;=0       64
    length | $mylist4        integers &gt;=0       47
     trunk | $mylist4        integers &gt;=0       18
--------------------------------------------------

</code></pre>
<p>
Instead of adding (or removing) single variables at a time, we can instead add or remove lists. Keeping with the comment above, you do <em>not</em> use <code>$</code> here to refer to the list.
</p>
<pre><code>. vl create mylist5 = mylist2 - mylist1
note: $mylist5 initialized with 2 variables

. vl list mylist5

------------------------------------------------
Variable | Macro           Values         Levels
---------+--------------------------------------
  length | $mylist5        integers &gt;=0       47
   trunk | $mylist5        integers &gt;=0       18
------------------------------------------------

</code></pre>
<p>
However, if we want to simply modify an existing list, a better approach would be the <code>vl modify</code> command. <code>vl create</code> and <code>vl modify</code> are similar to <code>generate</code> and <code>replace</code>; the former creates a new variable list while the later changes an existing variable list, but the syntax right of the <code>=</code> is the same.
</p>
<pre><code>. vl modify mylist3 = mylist3 + (headroom)
note: 1 variable added to $mylist3

. vl modify mylist3 = mylist3 - (weight)
note: 1 variable removed from $mylist3

</code></pre>
</div>
</div>
<div id="dropping-variable-list" class="section level2">
<h2><span class="header-section-number">3.4</span> Dropping variable list</h2>
<p>
Variable lists can be dropped via <code>vl drop</code>
</p>
<pre><code>. vl dir, user

-------------------------------------------------------------------------------
                  |                      Macro's contents
                  |------------------------------------------------------------
Macro             |  # Vars   Description
------------------+------------------------------------------------------------
User              |
  $mylist1        |       2   Related to gas consumption
  $mylist2        |       3   Related to size
  $mylist3        |       4   variables
  $mylist4        |       3   variables
  $mylist5        |       2   variables
-------------------------------------------------------------------------------

. vl drop mylist4 mylist5

. vl dir, user

-------------------------------------------------------------------------------
                  |                      Macro's contents
                  |------------------------------------------------------------
Macro             |  # Vars   Description
------------------+------------------------------------------------------------
User              |
  $mylist1        |       2   Related to gas consumption
  $mylist2        |       3   Related to size
  $mylist3        |       4   variables
-------------------------------------------------------------------------------

</code></pre>
<p>
System lists cannot be dropped; if you run <code>vl drop vlcontinuous</code> it just removes all the variables from it.
</p>
</div>
<div id="using-variable-lists" class="section level2">
<h2><span class="header-section-number">3.5</span> Using Variable Lists</h2>
<p>
To be explicit, we can use variable lists in any command which would take the variables in that list. For example,
</p>
<pre><code>. describe $mylist3

              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
length          int     %8.0g                 Length (in.)
trunk           int     %8.0g                 Trunk space (cu. ft.)
gear_ratio      float   %6.2f                 Gear Ratio
headroom        float   %6.1f                 Headroom (in.)

. describe $vlcategorical

              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
rep78           int     %8.0g                 Repair Record 1978

</code></pre>
<p>
We can also use them in a modeling setting.
</p>
<pre><code>. regress mpg $mylist3

      Source |       SS           df       MS      Number of obs   =        74
-------------+----------------------------------   F(4, 69)        =     30.77
       Model |  1565.65298         4  391.413244   Prob &gt; F        =    0.0000
    Residual |  877.806484        69  12.7218331   R-squared       =    0.6408
-------------+----------------------------------   Adj R-squared   =    0.6199
       Total |  2443.45946        73  33.4720474   Root MSE        =    3.5668

------------------------------------------------------------------------------
         mpg |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      length |  -.1837962   .0327629    -5.61   0.000    -.2491564   -.1184361
       trunk |  -.0103867   .1627025    -0.06   0.949    -.3349693    .3141959
  gear_ratio |   1.526952    1.27546     1.20   0.235    -1.017521    4.071426
    headroom |   .0136375   .6602514     0.02   0.984    -1.303528    1.330803
       _cons |   51.33708   8.300888     6.18   0.000     34.77727     67.8969
------------------------------------------------------------------------------

</code></pre>
<p>
However, we’ll run into an issue here - how to specify categorical variables or interactions? The <code>vl substitute</code> command creates “factor-variable lists” that can include factor variable indicators (<code>i.</code>), continuous variable indicators (<code>c.</code>), and interactions (<code>#</code> or <code>##</code>). (The name “factor-variable list” is slightly disingenuous; you could create a “factor-variable list” that includes no actual factors, for example, if you wanted to interact two continuous variables.)
</p>
<p>
Creating a factor-varible list via <code>vl substitute</code> can be done by specifying variables or variable lists.
</p>
<pre><code>. vl substitute sublist1 = mpg mylist3

. display &quot;$sublist1&quot;
mpg length trunk gear_ratio headroom

. vl dir

-------------------------------------------------------------------------------
                  |                      Macro's contents
                  |------------------------------------------------------------
Macro             |  # Vars   Description
------------------+------------------------------------------------------------
System            |
  $vldummy        |       1   0/1 variable
  $vlcategorical  |       1   categorical variable
  $vlcontinuous   |       9   continuous variables
  $vluncertain    |       0   perhaps continuous, perhaps categorical variables
  $vlother        |       0   all missing or constant variables
User              |
  $mylist1        |       2   Related to gas consumption
  $mylist2        |       3   Related to size
  $mylist3        |       4   variables
  $sublist1       |           factor-variable list
-------------------------------------------------------------------------------

</code></pre>
<p>
Note the use of <code>display “$listname”</code> instead of <code>vl list</code>. Factor-variable lists are not just lists of vairables, they also can include the features above, so must be displayed. Note that in the <code>vl dir</code>, “sublist1” has no number of variables listed, making it stand apart.
</p>
<p>
We can make this more interesting by actually including continuous/factor indicatores and/or interactions.
</p>
<pre><code>. vl substitute sublist2 = c.mylist1##i.vldummy

. display &quot;$sublist2&quot;
weight mpg i.foreign i.foreign#c.weight i.foreign#c.mpg

</code></pre>
<p>
Note the need to specify that mylist1 is continuous (with <code>c.</code>). It follows the normal convention that Stata assumes predictors in a model are continuous by default, unless they’re invloved in an interaction, in which case it assumes they are factors by default.
</p>
<pre><code>. regress price $sublist2

      Source |       SS           df       MS      Number of obs   =        74
-------------+----------------------------------   F(5, 68)        =     16.82
       Model |   351163805         5  70232760.9   Prob &gt; F        =    0.0000
    Residual |   283901591        68   4175023.4   R-squared       =    0.5530
-------------+----------------------------------   Adj R-squared   =    0.5201
       Total |   635065396        73  8699525.97   Root MSE        =    2043.3

------------------------------------------------------------------------------
       price |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      weight |   4.415037   .8529259     5.18   0.000      2.71305    6.117024
         mpg |    237.691   125.0383     1.90   0.062    -11.81907     487.201
             |
     foreign |
    Foreign  |   8219.603   7265.713     1.13   0.262    -6278.902    22718.11
             |
     foreign#|
    c.weight |
    Foreign  |   .7408054   1.647504     0.45   0.654    -2.546738    4.028348
             |
     foreign#|
       c.mpg |
    Foreign  |  -257.4683    155.426    -1.66   0.102     -567.616    52.67938
             |
       _cons |  -13285.44   5149.648    -2.58   0.012    -23561.41   -3009.481
------------------------------------------------------------------------------

</code></pre>
<div id="updating-factor-variable-lists" class="section level3">
<h3><span class="header-section-number">3.5.1</span> Updating factor-variable Lists</h3>
<p>
Factor-variable lists cannot be directly modified.
</p>
<pre><code>. display &quot;$sublist1&quot;
mpg length trunk gear_ratio headroom

. vl modify sublist1 = sublist1 - mpg
sublist1 not allowed
    vlusernames containing factor variables not allowed in this context
    r(198);

</code></pre>
<p>
However, if you create a factor-variable list using only other variable lists, if those lists get updated, so does the factor-variable list!
</p>
<pre><code>. vl create continuous = (turn trunk)
note: $continuous initialized with 2 variables

. vl create categorical = (rep78 foreign)
note: $categorical initialized with 2 variables

. vl substitute predictors = c.continuous##i.categorical

. display &quot;$predictors&quot;
turn trunk i.rep78 i.foreign i.rep78#c.turn i.foreign#c.turn i.rep78#c.trunk i.
&gt; foreign#c.trunk

. vl modify continuous = continuous - (trunk)
note: 1 variable removed from $continuous

. quiet vl rebuild

. display &quot;$predictors&quot;
turn i.rep78 i.foreign i.rep78#c.turn i.foreign#c.turn

</code></pre>
<p>
Note the call to <code>vl rebuild</code>. Among other things, it will re-generate the factor-variable lists. (It produces a <code>vl dir</code> output without an option to suppress it, hence the use of <a target="_blank" href="https://errickson.net/stata1/programming.html#quieting-the-output"><code>quiet</code></a>.)
</p>
</div>
</div>
<div id="stored-statistics" class="section level2">
<h2><span class="header-section-number">3.6</span> Stored Statistics</h2>
<p>
You may have noticed that certain characteristics of the variable are reported.
</p>
<pre><code>. vl list mylist3

--------------------------------------------------
  Variable | Macro           Values         Levels
-----------+--------------------------------------
  headroom | $mylist3        noninteger           
     trunk | $mylist3        integers &gt;=0       18
    length | $mylist3        integers &gt;=0       47
gear_ratio | $mylist3        noninteger           
--------------------------------------------------

</code></pre>
<p>
This reports some characteristics of the variables (integer, whether it’s non-negative) and the number of unique values. We can also see some other statistics:
</p>
<pre><code>. vl list mylist3, min max obs

-------------------------------------------------------------------------------
Variable | Macro           Values         Levels       Min       Max        Obs
---------+---------------------------------------------------------------------
headroom | $mylist3        noninteger                  1.5         5         74
   trunk | $mylist3        integers &gt;=0       18         5        23         74
  length | $mylist3        integers &gt;=0       47       142       233         74
gear_r~o | $mylist3        noninteger                 2.19      3.89         74
-------------------------------------------------------------------------------

</code></pre>
<p>
This is similar to <a target="_blank" href="https://www.stata.com/manuals/dcodebook.pdf"><code>codebook</code></a> except faster; these characteristics are saved at the time the variable list is created or modified and not updated automatically. If the data changes, this does <em>not</em> get updated.
</p>
<pre><code>. drop if weight &lt; 3000
(35 observations deleted)

. summarize weight

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
      weight |         39    3653.846    423.5788       3170       4840

. vl list (weight), min max obs

-------------------------------------------------------------------------------
Variable | Macro           Values         Levels       Min       Max        Obs
---------+---------------------------------------------------------------------
  weight | $vlcontinuous   integers &gt;=0       64      1760      4840         74
  weight | $mylist1        integers &gt;=0       64      1760      4840         74
  weight | $mylist2        integers &gt;=0       64      1760      4840         74
-------------------------------------------------------------------------------

</code></pre>
<p>
To re-generate these stored statistics, we call <code>vl set</code> again, with the <code>update</code> option.
</p>
<pre><code>. vl set, update

-------------------------------------------------------------------------------
                  |                      Macro's contents
                  |------------------------------------------------------------
Macro             |  # Vars   Description
------------------+------------------------------------------------------------
System            |
  $vldummy        |       1   0/1 variable
  $vlcategorical  |       1   categorical variable
  $vlcontinuous   |       9   continuous variables
  $vluncertain    |       0   perhaps continuous, perhaps categorical variables
  $vlother        |       0   all missing or constant variables
-------------------------------------------------------------------------------

. vl list (weight), min max obs

-------------------------------------------------------------------------------
Variable | Macro           Values         Levels       Min       Max        Obs
---------+---------------------------------------------------------------------
  weight | $vlcontinuous   integers &gt;=0       34      3170      4840         39
  weight | $mylist1        integers &gt;=0       34      3170      4840         39
  weight | $mylist2        integers &gt;=0       34      3170      4840         39
-------------------------------------------------------------------------------

</code></pre>
<p>
When the <code>update</code> option is passed, variable lists are not affected, only stored statistics are updated.
</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>My guess is that <code>nonotes</code> will become the default in a version or 2, once users become used to <code>vl</code>.<a href="variable-lists.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="frames.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
